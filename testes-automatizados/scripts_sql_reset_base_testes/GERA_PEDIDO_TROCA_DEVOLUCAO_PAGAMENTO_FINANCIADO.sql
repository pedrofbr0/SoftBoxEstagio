/*************************************************************************************************
 * GERA UM PEDIDO PARA O CASO DE TESTE "DevolucaoProdutoPagamentoFinanciado" EM TROCA/DEVOLUÇÃO
 *************************************************************************************************/
SET SERVEROUTPUT ON FORMAT WORD_WRAPPED;
DECLARE
  id_pedido number;
BEGIN  
  SELECT MAX(NRO_PEDIDO) INTO id_pedido FROM MV_PEDIDO WHERE NRO_LOJA = 1101;
  
  INSERT INTO MV_PEDIDO (NRO_PEDIDO, DT_ABERTURA_PEDIDO, DT_FECHAMENTO_PEDIDO, DT_FATURAMENTO_PEDIDO, VR_TOTAL_PRODUTOS, VR_TOTAL_SERVICOS, VR_TOTAL_DESCONTOS, QTDE_PARCELAS, FLAG_ENTRADA_PEDIDO, FLAG_ENTRADA_TABELA, VR_ENTRADA, NRO_ENDERECO, NRO_ENDERECO_PEDIDO, COMPLEMENTO_ENDERECO_PEDIDO, NRO_LOJA, OBS_ENDERECO_PEDIDO, FLAG_PLANILHA, FLAG_ANALISE_COMERCIAL, FLAG_ENDERECO_ENTREGA, NRO_TIPO_VENDA, NRO_CLIENTE, NRO_LOJA_CLIENTE, NRO_USUARIO, TIPO_CAMPANHA_PROMOCIONAL, STS_PEDIDO, FLAG_STS_LIBERACAO_CREDITO, NRO_STS_LIBERACAO_CREDITO, NRO_USUARIO_LIBERACAO_CREDITO, NRO_USUARIO_ATIVO, COD_LOGRADOURO, COD_BAIRRO, COD_CGL, FLAG_EXPORTACAO, NRO_PRE_PEDIDO, NRO_LOJA_PRE_PEDIDO, NRO_PDV, NRO_USUARIO_LIBERACAO_MANUAL, DT_LIBERACAO_CREDITO, NRO_IP_ESTACAO, QTDE_DIAS_CARENCIA_POSITIVA, IND_PEDIDO_JA_FECHADO, SUMARIO_ITEM, SUMARIO_SERVICO_ITEM, SUMARIO_SERVICO_PEDIDO, SUMARIO_IND_DEVOLVIDO, VERSAO_APP, FLAG_IMPRESSAO_RECIBOS, VR_TAC, VR_PRESTACAO, DT_VENCTO_1, CARENCIA_VENCTO_1, PLANO_COD_TIPO_TABELA, PLANO_COD_CONCEITO, IND_LIBERACAO_MIG, DT_VENCTO_INICIAL_1, IND_SPC_OBRIGATORIO, IND_ELEGIVEL_PROTECAO_MAIOR, IND_COMP_TABESP, NRO_PEDIDO_MANUAL, IND_FLEXIBILIZADO, NOME_USUARIO_LIB_ABRV, ARQUIVO_ORESA, VR_TOTAL_COMISSAO, FATOR_COMISSAO, PLANO_IND_JUROS_ADMINISTRADORA, PLANO_IND_CDCI, PLANO_CODIGO_SGR, PLANO_FATOR_PLANO, BLOQUEADO_CENTRAL_CREDITO, DT_MANUTENCAO) VALUES (id_pedido+1, to_char(sysdate-1,'dd/mm/yyyy'), to_char(sysdate-1,'dd/mm/yyyy'), to_char(sysdate-1,'dd/mm/yyyy'), '683,16', '0', '0', '1', '1', '1', '670', '1', null, null, '1101', null, '1', null, null, '53', '8310010130', '1101', '6699', null, '50', null, null, null, null, null, null, null, '0', null, null, '7', null, null, null, null, null, 'MINI SYSTEM SAMSUNG MX-J640 200W BIV', null, null, null, '3.00.00', 'N', '0', '13,16', to_char(sysdate-1,'dd/mm/yyyy'), '0', '98', '000', null, to_char(sysdate-1,'dd/mm/yyyy'), null, '0', null, null, null, null, null, '0', null, null, null, null, null, null, null);
  INSERT INTO MV_ITEM_PEDIDO_PRODUTO (COD_TIPO_AUTORIZACAO, NRO_AUTORIZACAO_VENDA, NRO_LOJA, NRO_LOJA_AUTORIZACAO_VENDA, NRO_LOJA_EMPENHO, NRO_GRUPO_ESTOQUE, COD_LOGRADOURO, NRO_GRUPO_PROMOCAO, NRO_PROMOCAO, NRO_DEPTO, NRO_EQUALIZACAO, COD_BAIRRO, COD_CGL, COD_TIPO_TABELA, COD_TIPO_TABELA_REVERSAO, NRO_LOJA_SAIDA_ESTOQUE, COD_TIPO_TABELA_INICIAL, NRO_PEDIDO, NRO_USUARIO, NRO_PRODUTO, NRO_ITEM_PEDIDO_PRODUTO, QTDE_PEDIDA_PRODUTO, QTDE_DEVOLVIDA_PRODUTO, NRO_EMPENHO, FLAG_SAIDA_ESTOQUE, DT_PREVISAO_ENTREGA, VR_UNITARIO_PRODUTO, VR_SERVICO_AGREGADO, CUSTO_GERENCIAL_SERVICO, PRECO_LISTA, PRECO_PARTIDA, FATOR_PRESTACAO, FATOR_CARENCIA, CUSTO_GERENCIAL, VR_ENTRADA_PRODUTO, DT_CADASTRO_ITEM_PRODUTO, IND_FATURAMENTO_ITEM_PEDIDO, DT_FATURAMENTO_ITEM_PEDIDO, QTDE_FATURADA_PRODUTO, OBS_ITEM_PEDIDO, DESC_INFO_ADICIONAL, NRO_ENDERECO, NRO_ENDERECO_ITEM, COMPLEMENTO_ENDERECO_ITEM, OBS_ENDERECO_ITEM, IND_AUTORIZACAO_VENDA, QTDE_CANCELADA_PRODUTO, NRO_CONTRATO, MARGEM_OBJETIVA, FLAG_AGRUPAMENTO_NF, NOVO_CUSTO, VR_FATURAMENTO_PRODUTO, VR_ENTRADA_PRODUTO_RD, IND_ELEGIVEL_SERVICO, PRECO_LISTA_EQUALIZADO, COMISSAO_PRODUTO, IND_ENTREGA_PRODUTO, ALIQUOTA_ICMS, PERC_MAX_DESCONTO, FLAG_SAIDA_ESTOQUE_EQUALIZADO, NRO_LOJA_EMPENHO_EQZ, VR_ICMS_SEM_EXCECAO_FISCAL, VR_ICMS_COM_EXCECAO_FISCAL, DT_RETENCAO, VR_FATURAMENTO_SERVICO, PERC_IMPOSTOS, NRO_KIT, NRO_SUBGRUPO_PRODUTO, NRO_GRUPO_PRODUTO, NRO_GRUPO_ESTOQUE_PRO, COD_CONCEITO_CLIENTE_PRO, NRO_GRUPO_ESTOQUE_EQZ, COD_CONCEITO_CLIENTE_EQZ, OBS_EMPENHO, COD_TIPO_TABELA_LIMITE, VR_EQUALIZACAO, MARGEM_MINIMA, CARENCIA_PROMOCAO, MARGEM_REALIZADA, VR_TAC_PRODUTO, VR_PRESTACAO_PRODUTO, IND_MONTAGEM, IND_MONTA_PRODUTO, DT_PREVISAO_MONTAGEM, IND_NF_PRESENTE, NRO_INFO_ADICIONAL, NRO_INFO_ADICIONAL_2, DESC_INFO_ADICIONAL_2, NRO_INFO_ADICIONAL_3, DESC_INFO_ADICIONAL_3, TAB_MAX_LIBERADA, NRO_LOJA_EQUALIZACAO, SEQ_KIT, NRO_PEDIDO_COMPRA, VR_COMPENSACAO, ID_ENTREGA_PEDIDO_COMPRA, IND_EQUALIZACAO_ASSOCIADA, NRO_LISTA_CASAMENTO, PRECO_MINIMO, PERC_COMISSAO_VENDEDOR, NRO_PRO, NRO_PRO_SEQ_MAN, NRO_PRO_SEQ_AUT_PREST, NRO_PRO_SEQ_AUT_PLANO, VR_SERVICO_FRETE, COD_SITUACAO_PRODUTO, NRO_ORDEM_MONTAGEM, FLAG_INTEGRACAO, NRO_PLANO_PROMOCAO, VALOR_COMISSAO, FAIXA_COMISSAO, PERC_COMISSAO, IND_CLIENTE_RETIRA_DEPOSITO, NRO_LOJA_REFERENCIA, NRO_PEDIDO_REFERENCIA, NRO_ITEM_PED_REFERENCIA, IND_INTEGRADO, NRO_RESERVA_ESTOQUE, VR_TROCA_PRODUTO, NRO_PERFIL_USUARIO_VENDA, IND_CANCELA_ULTIMO_CF, NRO_LOJA_RETIRADA, IND_EMPENHO_MANUAL, CUSTO_GERENCIAL_ERP, NB_MGMT_ITEM_COST, NB_MGMT_ITEM_COST_AVG, NB_MGMT_NET_COST, NB_MGMT_NET_COST_AVG, NB_MGMT_FINAN_ADJ, NB_MGMT_FINAN_ADJ_AVG, NB_MGMT_NET_COST_TAX, NB_MGMT_NET_COST_TAX_AVG, NB_MGMT_COST_AVG, PERCENTUAL_DEPARTAMENTO, NRO_ITEM_PEDIDO_COMPRA, NRO_DATA_ENTREGA, FLAG_CUSTO_ORIGEM_COMPRA, PERC_DESPESA_FINANCEIRA, DT_MANUTENCAO, VR_ENCARGOS_SERVICOS) values (null, null, '1101', null, '1101', '1', null, null, null, '26', null, null, null, '98', null, '1101', null, id_pedido+1, '6699', '223893', '1', '1', '0', 'RE', '0', null, '683,16', '0', '0', '649', '683,16', '1', '1', '358,77', '670', to_char(sysdate-1,'dd/mm/yyyy'), 'S', to_char(sysdate-1,'dd/mm/yyyy'), '1', null, null, '1', null, null, null, null, '0', null, '0', '1', '344,97', '683,16', null, null, null, null, '0', '18', null, null, null, null, null, null, '0', null, null, '6078', '218', null, null, null, null, null, null, null, '0', null, '59,32', '0', '13,16', '0', '0', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, '683,16', null, null, null, null, null, '0', 'AT', null, '0', null, '0', null, null, '0', null, null, null, null, null, null, '2', null, null, null, '271,66', '344,97', '320,23', '271,66', '252,18', '271,66', '252,18', '271,66', '252,18', '252,18', '1,04', null, null, null, null, null, null);
  INSERT INTO MV_PLANILHA_PAGTO_PEDIDO (NRO_SEQ_PAGTO_PEDIDO, FLAG_TIPO_PAGTO_PEDIDO, VR_PAGTO_PEDIDO, CONTA_PAGTO_PEDIDO_AGENCIA, CONTA_PAGTO_PEDIDO_NRO, CARTAO_PAGTO_NRO, NRO_DOCTO_PAGTO, DT_VENCTO_DOCTO_PAGTO, CONTA_CLIENTE_DT_CADASTRO_MES, CONTA_CLIENTE_DT_CADASTRO_ANO, VR_RECEBIDO_PEDIDO, NRO_PEDIDO, NRO_LOJA, COD_BANCO, NRO_FORMA_PAGTO, CARTAO_PAGTO_LOTE, NRO_FUNCIONARIO, NRO_PROTOCOLO, VR_IMPRESSAO, FLAG_TRANSACAO_TEF, COD_RETORNO_TEF, DT_PAGTO_ACORDO, VR_JUROS_ACORDO, VR_MULTA_ACORDO, VR_PAGTO_ACORDO, NRO_LOJA_PAGTO_ACORDO, FLAG_EXPORTACAO, PARCELA_DOCTO_PAGTO, REC_NRO_PEDIDO, REC_NRO_LOJA, VR_PLANILHA, CMC7_DOCTO_PAGTO, TEF_NRO_PEDIDO_ORIGINAL, TEF_NRO_LOJA_ORIGINAL, TEF_NRO_SEQ_ORIGINAL, SEQ_FIN, COD_CONTROLE_SCOPE, COD_AUTORIZACAO_RECARGA, QTDE_PARCELAS, NRO_PEDIDO_TIPO_VENDA, NRO_LOJA_ENTERPRISE, NRO_PEDIDO_ENTERPRISE, NRO_TRANSACAO_TEF, NRO_TIPO_CONVENIO_CDCI, PERC_JUROS, VR_JUROS, IND_JUROS_ADMINISTRADORA, VR_TOTAL_COMISSAO, FATOR_COMISSAO, NRO_AUTORIZACAO_VALE_TROCA, NRO_DIG_VALE_TROCA, NOME_INSTITUICAO_TEF, VR_DEVOLVIDO) VALUES ('1', 'E', '670', null, null, null, null, to_char(sysdate-1,'dd/mm/yyyy'), null, null, '670', id_pedido+1, '1101', null, '1', null, null, null, '670', 'N', null, null, null, null, null, null, '0', null, null, null, '670', null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null, null);
  INSERT INTO MV_PLANILHA_PAGTO_PEDIDO (NRO_SEQ_PAGTO_PEDIDO, FLAG_TIPO_PAGTO_PEDIDO, VR_PAGTO_PEDIDO, CONTA_PAGTO_PEDIDO_AGENCIA, CONTA_PAGTO_PEDIDO_NRO, CARTAO_PAGTO_NRO, NRO_DOCTO_PAGTO, DT_VENCTO_DOCTO_PAGTO, CONTA_CLIENTE_DT_CADASTRO_MES, CONTA_CLIENTE_DT_CADASTRO_ANO, VR_RECEBIDO_PEDIDO, NRO_PEDIDO, NRO_LOJA, COD_BANCO, NRO_FORMA_PAGTO, CARTAO_PAGTO_LOTE, NRO_FUNCIONARIO, NRO_PROTOCOLO, VR_IMPRESSAO, FLAG_TRANSACAO_TEF, COD_RETORNO_TEF, DT_PAGTO_ACORDO, VR_JUROS_ACORDO, VR_MULTA_ACORDO, VR_PAGTO_ACORDO, NRO_LOJA_PAGTO_ACORDO, FLAG_EXPORTACAO, PARCELA_DOCTO_PAGTO, REC_NRO_PEDIDO, REC_NRO_LOJA, VR_PLANILHA, CMC7_DOCTO_PAGTO, TEF_NRO_PEDIDO_ORIGINAL, TEF_NRO_LOJA_ORIGINAL, TEF_NRO_SEQ_ORIGINAL, SEQ_FIN, COD_CONTROLE_SCOPE, COD_AUTORIZACAO_RECARGA, QTDE_PARCELAS, NRO_PEDIDO_TIPO_VENDA, NRO_LOJA_ENTERPRISE, NRO_PEDIDO_ENTERPRISE, NRO_TRANSACAO_TEF, NRO_TIPO_CONVENIO_CDCI, PERC_JUROS, VR_JUROS, IND_JUROS_ADMINISTRADORA, VR_TOTAL_COMISSAO, FATOR_COMISSAO, NRO_AUTORIZACAO_VALE_TROCA, NRO_DIG_VALE_TROCA, NOME_INSTITUICAO_TEF, VR_DEVOLVIDO) VALUES ('2', 'F', '13,16', null, null, null, '555', to_char(sysdate-1,'dd/mm/yyyy'), null, null, '13,16', id_pedido+1, '1101', null, '44', '555', null, null, '13,16', 'N', null, null, null, null, null, null, '0', '1', null, null, '13,16', null, null, null, null, null, null, null, null, null, null, null, null, null, '100', '0', '0', null, null, null, null, null, null);
  INSERT INTO MV_PRECIFICACAO_ITEM_PEDIDO (NRO_PEDIDO, NRO_LOJA, NRO_ITEM_PEDIDO_PRODUTO, PERC_ACIMA_PL, PERC_COMERCIALIZACAO, PRECO_LISTA, PRECO_LISTA_ORIGINAL, VR_UNITARIO_PRODUTO, VR_FATURAMENTO_PRODUTO, PRECO_PARTIDA, VR_BASE_LUCRE_GANHE, VR_PERCENTUAL_LUCRE_GANHE, VR_LUCRE_GANHE, NRO_USUARIO_REAGENDAMENTO) values (id_pedido+1, '1101', '1', '80', '5', '649', null, '683,16', '683,16', '683,16', null, null, null, null);
  
  DBMS_OUTPUT.PUT_LINE('Pedido gerado -> nro_pedido = ' || (id_pedido+1));
END;